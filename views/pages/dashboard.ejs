<% include ../partials/admin-header.ejs %>
    <!--content-->

    <script>
       $(function(){
           $("#selectall").click(function(){
               $('input:checkbox').not(this).prop('checked', this.checked);
           });
       });


    </script>

    <div id="form-container" class="container">
       <form>
           <div class="row form-group">

               <input type="button" onclick='location.href="/news-create"' value="Создать">
               <input id="edit-btn" type="button" value="Правка" disabled onclick="onEditButtonClick()">
               <button>Удалить</button>
               <button>Опубликовать</button>

               <table border="1" class="tar">
                   <tr>
                       <th><input type="checkbox" id="selectall"/></th>
                       <th>Дата</th>
                       <th>Заголовок</th>
                       <th>Состояние</th>
                   </tr>
                   <% for(var i=0; i<items.length; i++) {%>
                   <tr>
                       <td align="center"><input type="checkbox" class="case" name="case" value=<%= items[i].id %>></td>
                       <td><%= items[i].date %></td>
                       <td><%= items[i].title %></td>
                       <td><%= items[i].status %></td>
                   </tr>

                   <% } %>

               </table>
           </div>

       </form>
    </div>

    <script>

        $('input[type="checkbox"]').change(function(event) {

            if ($(".case:checked").length === 1) {
                document.getElementById('edit-btn').disabled = false;
            }
            else {
                document.getElementById('edit-btn').disabled = true;
            }
        });

        function onEditButtonClick() {

            $('input:checkbox:checked').each(function(){
                jQuery.ajax({
                    url: '/edit-response',
                    type: 'POST',
                    data: $(this).serialize(),
                    success: function () {
                      location.href = '/news-edit'
                    },
                    error: function (xhr, str) {
                        alert('Возникла ошибка: ' + xhr.responseCode);
                    }
                });
            });
        }

    </script>
    <!---->

<% include ../partials/admin-footer.ejs %>